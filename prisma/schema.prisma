 
generator client {
  provider = "prisma-client-js"
}

datasource db {
  // provider = "postgresql"
  // url      = env("DATABASE_URL")
provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id      Int      @id @default(autoincrement())
  userId  String @unique
  email   String   @unique
  name    String
  userType          String        @default("FREE")  // "FREE", "PREMIUM", "ENTERPRISE"
  subscriptions Subscription[]
  
}

model PaypalToken {
  id          Int      @id @default(autoincrement())
  accessToken String   @unique
  expiresAt   DateTime
  createdAt   DateTime @default(now())

  @@index([expiresAt])
}

 


model Subscription {
  id                  String    @id @default(uuid())
  userId              String    // This references User.userId, not User.id
  planId              String    // P-5ML4271244454362WXNWU5NQ
  SubscriptionId String   @unique  // I-BW452GLLEP1G
  status              String    // ACTIVE, SUSPENDED, CANCELLED
  
  nextBillingTime     DateTime?
  lastPaymentAmount   Float?
  lastPaymentTime     DateTime?
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt

  // Relation to User
  user                User      @relation(fields: [userId], references: [userId],onDelete: Cascade)
  plan                 Plan @relation(fields: [planId], references: [id])
@@index([planId])
  @@index([userId])
}

model Plan {
  id          String         @id @default(uuid())
  paypalPlanId String        @unique  // P-5ML4271244454362WXNWU5NQ
  name        String         // "Basic", "Pro", "Enterprise"
  description String?
  price       Float
  currency    String         @default("USD")
  interval    String         // "MONTH", "YEAR"
  isActive    Boolean        @default(true)
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
  subscriptions Subscription[]
}